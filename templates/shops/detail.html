{% extends "base.html" %}

{% load leaflet_tags %}
{% load render_stars %}
{% block title %}{% if shop %}{{ shop.name }}{% endif %}{% endblock %}
{% block javascript %}
{% leaflet_js plugins="forms" %}
{{ geoform.media }}
{% endblock javascript %}

{% block stylesheet %}
{% leaflet_css plugins="forms" %}
{% endblock stylesheet %}

{% block content %}
{% if shop %}
<h1 class="shop-name">{{ shop.name }}</h1>
{% render_stars shop.rating %}
{% if shop.address %}<p>{{ shop.address }}</p>{% endif %}
{% if shop.roaster %}<p>Tostador</p>{% endif %}
{% if shop.product.all %}
<h2>Variedades</h2>
{% for bag in shop.product.all %}
<div class="coffee-product">
    <h3>{{ bag.brand }}</h3>
    <p>{{ bag.get_species_display }}</p>
    <p>{{ bag.get_origin_display }}</p>
</div>

{% endfor %}
{% endif %}
{% if shop.content %}
{{ shop.content }}
{% endif %}
{% leaflet_map "detail" %}
{% endif %}
{% endblock %}

{% block footer_scripts %}
<script>
    window.addEventListener("map:init", function (e) {
        var detail = e.detail;
        L.marker([{{ shop.location.1 }}, {{ shop.location.0 }}]).addTo(detail.map);
    }, false);
</script>
{% endblock %}